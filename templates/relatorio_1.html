{% extends "relatorio_base.html" %}
{% block content %}
    <!-- Cabeçalho -->
    <header class="text-center mb-4">
        <p class="mb-0" style="font-size: 12px;">RELATÓRIO MENSAL</p>
    </header>

    <!-- Título Principal -->
    <div class="d-flex align-items-center justify-content-center mb-3">
        <i class="fas fa-chart-line me-3 fs-4" style="color: var(--laranja-principal); margin-top: 6px;"></i>
        <h2 class="text-center mb-0">Resultados Mensais</h2>
    </div>

    <!-- Subtítulo -->
    <h5 class="text-center mb-4">{{ empresa }}</h5>

    <!-- Data do relatório -->
    <div class="text-end mb-4">
        <p class="fw-bold mb-0">{{ mes }} - {{ ano }}</p>
    </div>

    <!-- Gráfico Gerado -->
    <div class="grafico-coluna mb-5">
        <img src="{{ grafico }}" alt="Gráfico Resultados Mensais" class="img-fluid">
    </div>

    <!-- Container Indicadores -->
    <div class="container-fluid mb-5">
        <!-- Indicadores Laranja - Receitas/Entradas -->
        <div class="row justify-content-center g-3 mb-4">
            {% set receitas = [] %}
            {% for chave, valor in dados.items() if "Receita" in chave or "Entrada" in chave %}
                {% if receitas.append((chave, valor)) %}{% endif %}
            {% endfor %}

            {% for chave, valor in receitas[:3] %}
                <div class="col-auto">
                    <div class="indicador-retangulo" style="background-color: var(--laranja-principal);">
                        <h6 class="mb-0">{{ chave }}</h6>
                        <p class="mb-0 fs-5">R$ {{ valor|float|round(2)|string|replace('.', ',') }}</p>
                    </div>
                </div>
            {% endfor %}
        </div>

        <!-- Indicadores Verde - Custos/Despesas/Saídas -->
        <div class="row justify-content-center g-3">
            {% set custos = [] %}
            {% for chave, valor in dados.items() if "Custo" in chave or "Despesa" in chave or "Saída" in chave %}
                {% if custos.append((chave, valor)) %}{% endif %}
            {% endfor %}

            {% for chave, valor in custos[:4] %}
                <div class="col-auto">
                    <div class="indicador-retangulo" style="background-color: var(--verde-principal);">
                        <h6 class="mb-0">{{ chave }}</h6>
                        <p class="mb-0 fs-5">R$ {{ valor|float|round(2)|string|replace('.', ',') }}</p>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    <!-- Tabela Completa de Dados -->
    <div class="table-responsive mb-4">
        <table class="table table-striped table-hover">
            <thead>
                <tr class="table-dark">
                    <th>Indicador</th>
                    <th class="text-end">Valor</th>
                </tr>
            </thead>
            <tbody>
                {% for chave, valor in dados.items() if chave != "Empresa" %}
                    <tr>
                        <td>{{ chave }}</td>
                        <td class="text-end">R$ {{ valor|float|round(2)|string|replace('.', ',') }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="page-break"></div>
{% endblock %}